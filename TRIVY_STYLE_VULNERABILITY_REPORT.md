# Vulnerability Scan Report - Trivy Style
## vulnerable-transitive-app

**Scan Date:** 2026-01-29  
**Scanner:** npm audit (compatible with Trivy format)  
**Total Vulnerabilities:** 26  
**Severity Breakdown:**
- ðŸ”´ **Critical:** 1
- ðŸŸ  **High:** 12
- ðŸŸ¡ **Moderate:** 5
- ðŸ”µ **Low:** 8

---

## Executive Summary

This Node.js application contains **26 known security vulnerabilities** across its dependency tree. The vulnerabilities span both direct and transitive dependencies, with several requiring immediate attention due to their critical and high severity ratings.

**Key Findings:**
- 1 critical vulnerability in template rendering (ejs)
- Multiple high-severity issues in core dependencies (axios, express, jsonwebtoken)
- Significant transitive dependency vulnerabilities (qs, path-to-regexp, send)
- Deep dependency chain vulnerabilities through webpack tooling

---

## Critical Vulnerabilities (1)

### ðŸ”´ CVE-2023-29827: ejs Template Injection Vulnerability
**Package:** ejs  
**Current Version:** 3.1.6  
**Fixed Version:** 3.1.10  
**Severity:** CRITICAL  
**CVSS Score:** 9.8

**Description:**  
ejs template injection vulnerability allows remote attackers to execute arbitrary code via crafted template strings.

**Vulnerability Details:**
- **CVE IDs:** CVE-2023-29827, GHSA-phwq-j96m-2c2q
- **Dependency Type:** Direct
- **Attack Vector:** Network
- **User Interaction:** None Required

**Remediation:**
```json
"ejs": "3.1.10"  // Upgrade from 3.1.6
```

**References:**
- https://github.com/advisories/GHSA-phwq-j96m-2c2q
- https://github.com/advisories/GHSA-ghr5-ch3p-vcr6

---

## High Severity Vulnerabilities (12)

### ðŸŸ  CVE-2021-3749: Axios SSRF Vulnerability
**Package:** axios  
**Current Version:** 0.21.1  
**Fixed Version:** 0.21.4 or 1.6.0+  
**Severity:** HIGH  
**CVSS Score:** 7.5

**Description:**  
Axios allows Server-Side Request Forgery (SSRF) via URL manipulation, enabling attackers to make requests to internal resources.

**Vulnerability Details:**
- **CVE IDs:** CVE-2021-3749, GHSA-jr5f-v2jv-69x6
- **Dependency Type:** Direct
- **Additional Issues:**
  - Cross-Site Request Forgery (GHSA-wf5p-g6vw-rhxx)
  - Inefficient Regular Expression Complexity (GHSA-cph5-m8f7-6c5x)

**Remediation:**
```json
"axios": "1.6.7"  // Upgrade from 0.21.1
```

---

### ðŸŸ  CVE-2022-23529: jsonwebtoken Key Type Vulnerability
**Package:** jsonwebtoken  
**Current Version:** 8.5.1  
**Fixed Version:** 9.0.0+  
**Severity:** HIGH  
**CVSS Score:** 7.6

**Description:**  
Unrestricted key type could lead to legacy keys usage, enabling signature validation bypass and token forgery.

**Vulnerability Details:**
- **CVE IDs:** CVE-2022-23529, GHSA-8cf7-32gw-wr33
- **Dependency Type:** Direct
- **Additional Issues:**
  - RSA to HMAC algorithm confusion (GHSA-hjrf-2m68-5959)
  - Insecure default algorithm (GHSA-qwph-4952-7xr6)

**Remediation:**
```json
"jsonwebtoken": "9.0.2"  // Upgrade from 8.5.1 (BREAKING CHANGE)
```

**Breaking Change Notes:**
- API changes in v9.x
- Review jwt.verify() calls for algorithm specification

---

### ðŸŸ  CVE-2024-45590: body-parser DoS Vulnerability
**Package:** body-parser  
**Current Version:** 1.19.0  
**Fixed Version:** 1.20.3  
**Severity:** HIGH  
**CVSS Score:** 7.5

**Description:**  
Denial of Service when URL encoding is enabled due to inefficient parsing.

**Vulnerability Details:**
- **CVE IDs:** CVE-2024-45590, GHSA-qwcr-r2fm-qrc7
- **Dependency Type:** Direct
- **Transitive Impact:** Also affects express

**Remediation:**
```json
"body-parser": "1.20.3"  // Upgrade from 1.19.0
```

---

### ðŸŸ  CVE-2022-24999: qs Prototype Pollution
**Package:** qs  
**Current Version:** 6.7.0  
**Fixed Version:** 6.11.0+  
**Severity:** HIGH  
**CVSS Score:** 7.5

**Description:**  
Prototype pollution vulnerability allowing attackers to modify object prototypes.

**Vulnerability Details:**
- **CVE IDs:** CVE-2022-24999, GHSA-hrpp-h998-j3pp
- **Dependency Type:** **TRANSITIVE**
- **Dependency Chains:**
  1. app â†’ express@4.17.1 â†’ qs@6.7.0
  2. app â†’ express@4.17.1 â†’ body-parser@1.19.0 â†’ qs@6.7.0
  3. app â†’ body-parser@1.19.0 â†’ qs@6.7.0

**Additional Issues:**
- DoS via memory exhaustion (GHSA-6rw7-vpxm-498p)

**Remediation Strategy:**
**Option 1 (Preferred):** Upgrade direct dependency
```json
"express": "4.18.2",  // This will update qs transitively
"body-parser": "1.20.2"
```

**Option 2:** Use npm overrides
```json
"overrides": {
  "qs": "6.11.0"
}
```

---

### ðŸŸ  CVE-2024-45296: path-to-regexp ReDoS
**Package:** path-to-regexp  
**Current Version:** 0.1.7  
**Fixed Version:** 0.1.12  
**Severity:** HIGH  
**CVSS Score:** 7.5

**Description:**  
Regular Expression Denial of Service (ReDoS) through backtracking in pattern matching.

**Vulnerability Details:**
- **CVE IDs:** CVE-2024-45296, GHSA-9wv6-86v2-598j
- **Dependency Type:** **TRANSITIVE** (via express)
- **Dependency Chain:** app â†’ express@4.17.1 â†’ path-to-regexp@0.1.7

**Remediation:**
```json
"express": "4.18.2"  // Updates path-to-regexp transitively
```

---

### ðŸŸ  CVE-2024-43788: send XSS via Template Injection
**Package:** send  
**Current Version:** 0.17.1  
**Fixed Version:** 0.19.0  
**Severity:** HIGH  
**CVSS Score:** 7.1

**Description:**  
Template injection vulnerability leading to Cross-Site Scripting (XSS).

**Vulnerability Details:**
- **CVE IDs:** CVE-2024-43788, GHSA-m6fv-jmcg-4jfg
- **Dependency Type:** **TRANSITIVE** (via express, serve-static)
- **Dependency Chains:**
  1. app â†’ express@4.17.1 â†’ send@0.17.1
  2. app â†’ express@4.17.1 â†’ serve-static â†’ send@0.17.1

**Remediation:**
```json
"express": "4.18.2"  // Updates send transitively
```

---

### ðŸŸ  CVE-2024-37890: braces ReDoS
**Package:** braces  
**Current Version:** 2.3.2  
**Fixed Version:** 3.0.3  
**Severity:** HIGH  
**CVSS Score:** 7.5

**Description:**  
Uncontrolled resource consumption through inefficient regular expression complexity.

**Vulnerability Details:**
- **CVE IDs:** CVE-2024-37890, GHSA-grv7-fg5c-xmjg
- **Dependency Type:** **DEEP TRANSITIVE** (via webpack)
- **Dependency Chain:** app â†’ webpack-cli â†’ webpack â†’ watchpack â†’ chokidar â†’ braces

**Remediation Strategy:**
**Option 1 (Breaking Change):**
```json
"webpack": "5.89.0",      // Major version upgrade
"webpack-cli": "5.1.4"
```

**Option 2 (Conservative):**
```json
"overrides": {
  "braces": "3.0.3"
}
```

---

### ðŸŸ  CVE-2020-28498: Elliptic Cryptographic Implementation Weakness
**Package:** elliptic  
**Current Version:** 6.5.4  
**Fixed Version:** 6.5.7  
**Severity:** HIGH  
**CVSS Score:** 7.5

**Description:**  
Uses a cryptographic primitive with a risky implementation that could allow signature malleability.

**Vulnerability Details:**
- **CVE IDs:** CVE-2020-28498, GHSA-848j-6mx2-7j84
- **Dependency Type:** **DEEP TRANSITIVE** (via webpack toolchain)
- **Dependency Chain:** app â†’ webpack â†’ node-libs-browser â†’ crypto-browserify â†’ elliptic

**Remediation:**
```json
"webpack": "5.89.0"  // Major upgrade removes this dependency
```
OR
```json
"overrides": {
  "elliptic": "6.5.7"
}
```

---

### ðŸŸ  Cookie Header Parsing Vulnerability
**Package:** cookie  
**Current Version:** 0.4.0  
**Fixed Version:** 0.7.0  
**Severity:** HIGH

**Description:**  
Accepts cookie name, path, and domain with out-of-bounds characters.

**Vulnerability Details:**
- **CVE IDs:** GHSA-pxg6-pf52-xh8x
- **Dependency Type:** **TRANSITIVE** (via express)

**Remediation:**
```json
"express": "4.18.2"  // Updates cookie transitively
```

---

## Moderate Severity Vulnerabilities (5)

### ðŸŸ¡ Multiple webpack-related vulnerabilities
**Packages:** webpack, webpack-cli, micromatch, findup-sync  
**Current Versions:** Various  
**Severity:** MODERATE  

**Description:**  
Multiple moderate-severity issues in the webpack build toolchain affecting development dependencies.

**Remediation:**
```json
"devDependencies": {
  "webpack": "5.89.0",
  "webpack-cli": "5.1.4"
}
```

---

## Low Severity Vulnerabilities (8)

Multiple low-severity vulnerabilities exist in the dependency tree, primarily in development dependencies and build tools. These should be addressed as part of regular maintenance.

---

## Dependency Analysis

### Direct Dependencies with Vulnerabilities

| Package | Current | Latest Safe | Severity | Type |
|---------|---------|-------------|----------|------|
| axios | 0.21.1 | 1.6.7 | HIGH | Direct |
| ejs | 3.1.6 | 3.1.10 | CRITICAL | Direct |
| jsonwebtoken | 8.5.1 | 9.0.2 | HIGH | Direct |
| body-parser | 1.19.0 | 1.20.3 | HIGH | Direct |
| express | 4.17.1 | 4.18.2 | HIGH | Direct |
| dotenv | 8.2.0 | 16.4.5 | LOW | Direct |

### Transitive Dependencies with Vulnerabilities

| Package | Via | Current | Fixed | Severity |
|---------|-----|---------|-------|----------|
| qs | express, body-parser | 6.7.0 | 6.11.0 | HIGH |
| path-to-regexp | express | 0.1.7 | 0.1.12 | HIGH |
| send | express, serve-static | 0.17.1 | 0.19.0 | HIGH |
| cookie | express | 0.4.0 | 0.7.0 | HIGH |
| braces | webpack chain | 2.3.2 | 3.0.3 | HIGH |
| elliptic | webpack chain | 6.5.4 | 6.5.7 | HIGH |

---

## Remediation Recommendations

### Priority 1: Immediate Action Required (Critical)

```json
{
  "dependencies": {
    "ejs": "3.1.10"  // Fix critical template injection
  }
}
```

### Priority 2: High Severity (Next 7 days)

```json
{
  "dependencies": {
    "axios": "1.6.7",
    "jsonwebtoken": "9.0.2",
    "express": "4.18.2",
    "body-parser": "1.20.3"
  }
}
```

### Priority 3: Development Dependencies (Next 30 days)

```json
{
  "devDependencies": {
    "webpack": "5.89.0",
    "webpack-cli": "5.1.4"
  }
}
```

### Alternative: Conservative Approach Using Overrides

If major upgrades cause breaking changes:

```json
{
  "dependencies": {
    "ejs": "3.1.10",
    "axios": "1.6.7",
    "jsonwebtoken": "9.0.2",
    "express": "4.18.2",
    "body-parser": "1.20.3"
  },
  "overrides": {
    "qs": "6.11.0",
    "braces": "3.0.3",
    "elliptic": "6.5.7"
  }
}
```

---

## Complete Remediation Patch

### Approach 1: Direct Upgrades (Recommended)

```diff
--- a/package.json
+++ b/package.json
@@ -8,12 +8,12 @@
     "audit-json": "npm audit --json > audit-report.json"
   },
   "dependencies": {
-    "express": "4.17.1",
-    "body-parser": "1.19.0",
-    "ejs": "3.1.6",
-    "axios": "0.21.1",
-    "jsonwebtoken": "8.5.1",
-    "dotenv": "8.2.0"
+    "express": "4.18.2",
+    "body-parser": "1.20.3",
+    "ejs": "3.1.10",
+    "axios": "1.6.7",
+    "jsonwebtoken": "9.0.2",
+    "dotenv": "16.4.5"
   },
   "devDependencies": {
-    "webpack": "4.46.0",
-    "webpack-cli": "3.3.12"
+    "webpack": "5.89.0",
+    "webpack-cli": "5.1.4"
   }
```

### Approach 2: With Overrides (Conservative)

```json
{
  "dependencies": {
    "express": "4.18.2",
    "body-parser": "1.20.3",
    "ejs": "3.1.10",
    "axios": "1.6.7",
    "jsonwebtoken": "9.0.2",
    "dotenv": "16.4.5"
  },
  "devDependencies": {
    "webpack": "4.46.0",
    "webpack-cli": "3.3.12"
  },
  "overrides": {
    "braces": "3.0.3",
    "elliptic": "6.5.7",
    "minimist": "1.2.8"
  }
}
```

---

## Validation Commands

After applying patches:

```bash
# Reinstall dependencies
npm install

# Verify vulnerabilities are fixed
npm audit

# Check specific packages
npm ls qs          # Should show 6.11.0+
npm ls axios       # Should show 1.6.7+
npm ls ejs         # Should show 3.1.10+
npm ls jsonwebtoken # Should show 9.0.2+

# Test application
npm start
```

---

## Expected Results After Remediation

**Before:**
- 26 vulnerabilities (1 critical, 12 high, 5 moderate, 8 low)

**After (Approach 1):**
- 0 high/critical vulnerabilities
- Potential low-severity warnings from outdated tooling

**After (Approach 2):**
- 0-3 low-severity vulnerabilities remaining
- All critical and high vulnerabilities resolved

---

## Additional Security Recommendations

1. **Enable Automated Scanning:**
   - Set up Dependabot or Renovate for automated dependency updates
   - Configure CI/CD to fail on high/critical vulnerabilities

2. **Regular Audits:**
   - Run `npm audit` before each deployment
   - Review and update dependencies monthly

3. **Security Best Practices:**
   - Implement input validation for all user data
   - Use environment variables for sensitive configuration
   - Enable rate limiting and CORS policies
   - Implement proper authentication and authorization

4. **Monitoring:**
   - Subscribe to security advisories for critical packages
   - Monitor npm security bulletins
   - Use tools like Snyk, WhiteSource, or GitHub Security Alerts

---

## Report Metadata

**Generated:** 2026-01-29  
**Scanner:** npm audit v10.9.4  
**Package Manager:** npm  
**Node Version:** v20.x  
**Project:** vulnerable-transitive-app v1.0.0  
**Total Dependencies:** 506 packages  
**Scan Duration:** ~14 seconds

---

## Appendix: Full Vulnerability List

### Critical (1)
1. ejs@3.1.6 - Template Injection (CVE-2023-29827)

### High (12)
1. axios@0.21.1 - SSRF (CVE-2021-3749)
2. axios@0.21.1 - CSRF (GHSA-wf5p-g6vw-rhxx)
3. axios@0.21.1 - ReDoS (GHSA-cph5-m8f7-6c5x)
4. jsonwebtoken@8.5.1 - Key Type Vulnerability (CVE-2022-23529)
5. jsonwebtoken@8.5.1 - Algorithm Confusion (GHSA-hjrf-2m68-5959)
6. jsonwebtoken@8.5.1 - Insecure Default (GHSA-qwph-4952-7xr6)
7. body-parser@1.19.0 - DoS (CVE-2024-45590)
8. qs@6.7.0 - Prototype Pollution (CVE-2022-24999)
9. path-to-regexp@0.1.7 - ReDoS (CVE-2024-45296)
10. send@0.17.1 - XSS (CVE-2024-43788)
11. braces@2.3.2 - ReDoS (CVE-2024-37890)
12. elliptic@6.5.4 - Weak Crypto (CVE-2020-28498)

### Moderate (5)
Various webpack-related tooling vulnerabilities

### Low (8)
Various development dependency issues

---

**End of Report**
